/**
 * @file hello_world.c
 *
 * @section desc File description
 *
 *
 * @section copyright Copyright
 *
 *
 * @section infos File informations
 *
 * $Date$ ven. 28 f√©vr. 2025 16:27:40 CET
 * $Rev$
 * $Author$ lht1404
 * $URL$ /home/lht1404/hello_world
 */

#include "contiki.h"
#include "board-peripherals.h"
#include <stdio.h>
#include <stdint.h>
#include <sys/etimer.h>
#include "lib/sensors.h"


PROCESS(hello_world_process, "hello_world process");
AUTOSTART_PROCESSES(&hello_world_process);

PROCESS_THREAD(hello_world_process, ev, data) 
{
    PROCESS_BEGIN();
    static struct etimer timer;
    int temp;
    int humidity;

    SENSORS_ACTIVATE(hdc_1000_sensor);

    
    etimer_set(&timer, CLOCK_SECOND * 10);

    while(1){
        SENSORS_ACTIVATE(hdc_1000_sensor);
        
        PROCESS_WAIT_EVENT_UNTIL(etimer_expired(&timer));
        etimer_reset(&timer);
        
        humidity = hdc_1000_sensor.value(HDC_1000_SENSOR_TYPE_HUMID);
        temp = hdc_1000_sensor.value(HDC_1000_SENSOR_TYPE_TEMP);

        printf("Temp: %d.%d \n", temp/100, temp%100);
        printf("Humidity: %d.%d \n", humidity/100, humidity%100);

    }
    

    PROCESS_END();
}